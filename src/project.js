require=function n(l,a,c){function s(t,e){if(!a[t]){if(!l[t]){var o="function"==typeof require&&require;if(!e&&o)return o(t,!0);if(p)return p(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var r=a[t]={exports:{}};l[t][0].call(r.exports,function(e){return s(l[t][1][e]||e)},r,r.exports,n,l,a,c)}return a[t].exports}for(var p="function"==typeof require&&require,e=0;e<c.length;e++)s(c[e]);return s}({add_collider:[function(e,t,o){"use strict";cc._RF.push(t,"5e14d3E1d1JQ7M0cQ07e9cO","add_collider"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./global"),i=cc._decorator,r=i.ccclass,l=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){this.tl=this.getComponent(cc.TiledLayer);for(var e=this.tl.getLayerSize(),t=this.tl.getMapTileSize(),o=0;o<e.width;o++)for(var i=0;i<e.height;i++)if(0!==this.tl.getTileGIDAt(o,i)){var r=this.addComponent(cc.BoxCollider);r.offset=n.Global.TM.tileToPositionAR(new cc.Vec2(o,i)),r.size=new cc.Size(t.width,t.height)}},t.prototype.removeTileAtPosition=function(e){this.tl.removeTileAt(n.Global.TM.positionToTile(this.node.parent.convertToWorldSpaceAR(e)))},t=__decorate([r],t)}(cc.Component));o.default=l,cc._RF.pop()},{"./global":"global"}],bullet:[function(e,t,o){"use strict";cc._RF.push(t,"f9119+Uqq5Lt7phDQEBFNO9","bullet"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./enemy"),l=e("./player"),a=e("./add_collider"),c=e("./global"),i=cc._decorator,r=i.ccclass,s=(i.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.SPEED=800,e}return __extends(e,t),e.prototype.onLoad=function(){this.target&&(this.direction=this.target.sub(this.node.position).normalize())},e.prototype.update=function(e){var t=cc.director.getVisibleSize(),o=this.node.position;if(o.x>t.width/2||o.x<-t.width/2||o.y>t.height/2||o.y<-t.height/2)return this.node.destroy();this.target&&(this.node.position=o.add(this.direction.mul(e*this.SPEED)))},e.prototype.onCollisionEnter=function(e,t){if(0===e.tag&&this.from!=e.node&&cc.isValid(this.node)){this.node.destroy();var o=e.getComponent(a.default);o&&!c.Global.TM.isEdge(e.offset)&&(o.removeTileAtPosition(e.offset),e.destroy());var i=e.getComponent(n.default);i&&(i.health-=1);var r=e.getComponent(l.default);r&&(r.health-=1)}},e=__decorate([r],e)}(cc.Component));o.default=s,cc._RF.pop()},{"./add_collider":"add_collider","./enemy":"enemy","./global":"global","./player":"player"}],canvas:[function(e,t,o){"use strict";cc._RF.push(t,"9575aM3ObpPNryRs5LB5JYc","canvas"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./global"),l=e("./player"),i=cc._decorator,r=i.ccclass,a=i.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.overlay=null,e.overlayTitle=null,e.overlayButton=null,e.elixirProgressBar=null,e.elixirValue=null,e.bulletValue=null,e.healthValue=null,e.playerPrefab=null,e}return __extends(e,t),e.prototype.onLoad=function(){var o=this;cc.view.enableAntiAlias(!1),cc.director.getCollisionManager().enabled=!0,(n.Global.CanvasScript=this).overlay.zIndex=1;var i=window.io("http://insraq.duckdns.org:4000");(n.Global.Socket=i).emit("new player"),this.showOverlay("Finding Players",!1);var r=this.overlayTitle.node.runAction(cc.repeatForever(cc.sequence(cc.fadeOut(.5),cc.fadeIn(.5),cc.delayTime(.5))));i.on("spawn player",function(e){o.hideOverlay(),o.overlayTitle.node.stopAction(r),o.overlayTitle.node.runAction(cc.fadeIn(.25)),n.Global.PlayerNode=cc.instantiate(o.playerPrefab),n.Global.PlayerScript=n.Global.PlayerNode.getComponent(l.default),n.Global.PlayerNode.position=n.Global.TM.tileToPositionAR(new cc.Vec2(e.playerX,e.playerY)),n.Global.PlayerScript.isPlayer=!0,n.Global.PlayerNode.parent=o.node;var t=cc.instantiate(o.playerPrefab);t.position=n.Global.TM.tileToPositionAR(new cc.Vec2(e.enemyX,e.enemyY)),t.parent=o.node,t.getComponent(l.default).enemy=n.Global.PlayerNode,n.Global.PlayerScript.enemy=t,i.on("player move sync",function(e){t.getComponent(l.default).command(e.cardId)}),i.on("enemy left",function(){o.showOverlay("You Won!\n(Enemy Left)")})})},e.prototype.update=function(e){n.Global.PlayerNode&&(this.elixirProgressBar.progress=n.Global.PlayerScript.elixir/l.default.MAX_ELIXIR,this.elixirValue.string=Math.floor(n.Global.PlayerScript.elixir).toString(),this.healthValue.string=n.Global.PlayerScript.health.toString(),this.bulletValue.string=n.Global.PlayerScript.bullet.toString())},e.prototype.showOverlay=function(e,t){void 0===t&&(t=!0),n.Global.Pause=!0,this.overlay.active=!0,this.overlayTitle.string=e,this.overlayButton.active=t},e.prototype.hideOverlay=function(){n.Global.Pause=!1,this.overlay.active=!1},e.prototype.restart=function(){n.Global.Pause=!1,cc.director.loadScene(cc.director.getScene().name)},__decorate([a(cc.Node)],e.prototype,"overlay",void 0),__decorate([a(cc.Label)],e.prototype,"overlayTitle",void 0),__decorate([a(cc.Node)],e.prototype,"overlayButton",void 0),__decorate([a(cc.ProgressBar)],e.prototype,"elixirProgressBar",void 0),__decorate([a(cc.Label)],e.prototype,"elixirValue",void 0),__decorate([a(cc.Label)],e.prototype,"bulletValue",void 0),__decorate([a(cc.Label)],e.prototype,"healthValue",void 0),__decorate([a(cc.Prefab)],e.prototype,"playerPrefab",void 0),e=__decorate([r],e)}(cc.Component);o.default=c,cc._RF.pop()},{"./global":"global","./player":"player"}],card:[function(e,t,i){"use strict";cc._RF.push(t,"942448n3ONNwrfxrd0XnHxW","card"),Object.defineProperty(i,"__esModule",{value:!0});var r=e("./global"),o=cc._decorator,n=o.ccclass,l=o.property,a={cardName:"Aim and Shoot".toUpperCase(),elixir:3,bullet:1,action:function(e){e.shoot()}};i.Cards=[a,a,a,a,{cardName:"Up +1".toUpperCase(),elixir:1,bullet:0,action:function(e){e.move("up")}},{cardName:"Left +1".toUpperCase(),elixir:1,bullet:0,action:function(e){e.move("left")}},{cardName:"Right +1".toUpperCase(),elixir:1,bullet:0,action:function(e){e.move("right")}},{cardName:"Down +1".toUpperCase(),elixir:1,bullet:0,action:function(e){e.move("down")}},{cardName:"Up +3".toUpperCase(),elixir:2,bullet:0,action:function(e){e.move("up"),e.move("up"),e.move("up")}},{cardName:"Left +3".toUpperCase(),elixir:2,bullet:0,action:function(e){e.move("left"),e.move("left"),e.move("left")}},{cardName:"Right +3".toUpperCase(),elixir:2,bullet:0,action:function(e){e.move("right"),e.move("right"),e.move("right")}},{cardName:"Down +3".toUpperCase(),elixir:2,bullet:0,action:function(e){e.move("down"),e.move("down"),e.move("down")}},{cardName:"Bullet +2".toUpperCase(),elixir:2,bullet:0,action:function(e){e.bullet+=2}},{cardName:"Health +1".toUpperCase(),elixir:2,bullet:0,action:function(e){e.health+=1}}];var c=function(e){for(var t=e.length-1;0<t;t--){var o=Math.floor(Math.random()*(t+1));i=[e[o],e[t]],e[t]=i[0],e[o]=i[1]}return e;var i}(i.Cards.slice(0)),s=0,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cardName=null,e.elixir=null,e}return __extends(e,t),e.prototype.onLoad=function(){this._initialPosition=this.node.position,this._initialElixirColor=this.elixir.node.color,this._initialNameColor=this.cardName.node.color,this.drawCard()},e.prototype.drawCard=function(){s++,this._currentCard=c[s%c.length],this.cardName.string=this._currentCard.cardName,this.elixir.string=this._currentCard.elixir.toString()},e.prototype.currentCard=function(){return this._currentCard},e.prototype.onClick=function(e){var t=this;if(this._canBeUsed()){r.Global.PlayerScript.elixir=r.Global.PlayerScript.elixir-this.currentCard().elixir;var o=i.Cards.indexOf(this.currentCard());r.Global.Socket.emit("player move",{cardId:o}),r.Global.PlayerScript.command(o),this.node.runAction(cc.sequence(cc.spawn(cc.moveBy(.25,0,300),cc.scaleTo(.25,1.25,1.25),cc.fadeOut(.25)),cc.callFunc(function(){t.drawCard()}),cc.place(this._initialPosition),cc.delayTime(1),cc.spawn(cc.scaleTo(.25,1,1),cc.fadeIn(.25))))}},e.prototype.update=function(e){this._canBeUsed()?(this.cardName.node.color=this._initialNameColor,this.elixir.node.color=this._initialElixirColor):(this.cardName.node.color=new cc.Color(150,150,150),this.elixir.node.color=new cc.Color(150,150,150))},e.prototype._canBeUsed=function(){return r.Global.PlayerScript&&r.Global.PlayerScript.elixir>=this.currentCard().elixir},__decorate([l(cc.Label)],e.prototype,"cardName",void 0),__decorate([l(cc.Label)],e.prototype,"elixir",void 0),e=__decorate([n],e)}(cc.Component);i.default=p,cc._RF.pop()},{"./global":"global"}],enemy:[function(e,t,o){"use strict";cc._RF.push(t,"8feb78BCvxFRYDDXm1jiSJI","enemy"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./bullet"),r=e("./global"),n=cc._decorator,l=n.ccclass,a=n.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.progressBar=null,e.bulletPrefab=null,e.player=null,e._overlap={},e.MAX_HEALTH=5,e}return __extends(e,t),Object.defineProperty(e.prototype,"health",{get:function(){return this._health},set:function(e){e==this._health-1&&(this.node.runAction(cc.sequence(cc.blink(1,5),cc.show())),this.playSound("hit")),e>this._health&&this.node.runAction(cc.sequence(cc.scaleTo(.25,1.5,1.5),cc.scaleTo(.25,1,1))),e<=0?r.Global.CanvasScript.showOverlay("You Won!"):(this._health=e,this.progressBar&&(this.progressBar.progress=e/this.MAX_HEALTH))},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){var t=this;this.size=this.node.getContentSize().width,this.health=this.MAX_HEALTH,this.schedule(function(){if(!r.Global.Pause){var e=Math.random();e<.2?t.move("up"):e<.4?t.move("left"):e<.6?t.move("right"):e<.8?t.move("down"):e<.9&&t.health<t.MAX_HEALTH?t.health+=1:t.shoot()}},2,cc.macro.REPEAT_FOREVER)},e.prototype.move=function(e,t){var o,i=this.node.position;switch(e){case"up":o=new cc.Vec2(i.x,i.y+this.size);break;case"down":o=new cc.Vec2(i.x,i.y-this.size);break;case"right":o=new cc.Vec2(i.x+this.size,i.y);break;case"left":o=new cc.Vec2(i.x-this.size,i.y)}o&&!this._overlap[o.toString()]&&this.node.runAction(cc.sequence(cc.moveTo(.25,o),cc.callFunc(function(){t&&t()})))},e.prototype.shoot=function(){var e=cc.instantiate(this.bulletPrefab);e.getComponent(i.default).target=this.player.position,e.getComponent(i.default).from=this.node,e.position=this.node.position,e.parent=this.node.parent,this.playSound("shoot")},e.prototype.playSound=function(e){for(var t=0,o=this.getComponents(cc.AudioSource);t<o.length;t++){var i=o[t];if(-1!==String(i.clip).indexOf(e))return void i.play()}},e.prototype.onCollisionEnter=function(e,t){var o=e.world.aabb,i=this.node.parent.convertToNodeSpaceAR(new cc.Vec2(o.x+o.width/2,o.y+o.width/2));this._overlap[i.toString()]=!0},__decorate([a(cc.ProgressBar)],e.prototype,"progressBar",void 0),__decorate([a(cc.Prefab)],e.prototype,"bulletPrefab",void 0),__decorate([a(cc.Node)],e.prototype,"player",void 0),e=__decorate([l],e)}(cc.Component);o.default=c,cc._RF.pop()},{"./bullet":"bullet","./global":"global"}],global:[function(e,t,o){"use strict";cc._RF.push(t,"afee5nfPnxFnY58k8UHsitI","global"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function e(e,t){this.tileSize=e,this.layerSize=t}return e.prototype.tileToPositionAR=function(e){return new cc.Vec2(this.tileSize.width*(e.x+.5-this.layerSize.width/2),(this.layerSize.height/2-e.y-.5)*this.tileSize.height)},e.prototype.positionToTile=function(e){return new cc.Vec2(Math.floor(e.x/this.tileSize.width),this.layerSize.height-1-Math.floor(e.y/this.tileSize.height))},e.prototype.isEdge=function(e){var t=this.positionToTile(e);return 0==t.x||t.x==this.tileSize.width-1||0==t.y||t.y==this.tileSize.height-1},e}(),r={PlayerNode:null,PlayerScript:null,CanvasScript:null,Pause:!1,TM:new(o.TileMapCalc=i)(new cc.Size(32,32),new cc.Size(18,32)),Socket:null};o.Global=r,cc._RF.pop()},{}],player:[function(e,t,o){"use strict";cc._RF.push(t,"e1b90/rohdEk4SdmmEZANaD","player"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./bullet"),r=e("./global"),n=e("./card"),l=e("./add_collider"),a=cc._decorator,c=a.ccclass,s=a.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bulletPrefab=null,e.heathProgressBar=null,e.enemySpriteFrame=null,e.enemy=null,e.isPlayer=!1,e._elixir=5,e._overlap={},e._moveQueue=[],e._moving=!1,e}return __extends(e,t),o=e,Object.defineProperty(e.prototype,"bullet",{get:function(){return this._bullet},set:function(e){this._bullet=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"health",{get:function(){return this._health},set:function(e){e>o.MAX_HEALTH||(e==this._health-1&&(this.node.runAction(cc.sequence(cc.blink(1,5),cc.fadeIn(.25))),this.playSound(this.isPlayer?"hurt":"hit")),e>this._health&&this.node.runAction(cc.sequence(cc.scaleTo(.25,1.5,1.5),cc.scaleTo(.25,1,1))),e<=0?r.Global.CanvasScript.showOverlay(this.isPlayer?"You Lost!":"You Won!"):(this.heathProgressBar.progress=e/o.MAX_HEALTH,this._health=e))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"elixir",{get:function(){return this._elixir},set:function(e){this._elixir=e},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){this.size=this.node.getContentSize().width,this.health=o.MAX_HEALTH,this.bullet=5,this.health=5,this.isPlayer||(this.getComponent(cc.Sprite).spriteFrame=this.enemySpriteFrame)},e.prototype.playSound=function(e){for(var t=0,o=this.getComponents(cc.AudioSource);t<o.length;t++){var i=o[t];if(-1!==String(i.clip).indexOf(e))return void i.play()}},e.prototype.command=function(e){n.Cards[e].action(this)},e.prototype.move=function(e){this._moveQueue.push(e)},e.prototype.update=function(e){r.Global.Pause||(this.elixir<=o.MAX_ELIXIR&&(this.elixir+=.5*e),!this._moving&&0<this._moveQueue.length&&this._processMove())},e.prototype._processMove=function(){var e=this;this._moving=!0;this.node.position;var t,o=this._moveQueue.shift(),i=r.Global.TM.positionToTile(this.node.parent.convertToWorldSpaceAR(this.node.position));switch(o){case"up":t=new cc.Vec2(i.x,i.y-1);break;case"down":t=new cc.Vec2(i.x,i.y+1);break;case"right":t=new cc.Vec2(i.x+1,i.y);break;case"left":t=new cc.Vec2(i.x-1,i.y)}t&&!this._overlap[t.toString()]?this.node.runAction(cc.sequence(cc.moveTo(.25,r.Global.TM.tileToPositionAR(t)),cc.callFunc(function(){e._moving=!1}))):this._moving=!1},e.prototype.shoot=function(){if(!(this.bullet<=0)){var e=cc.instantiate(this.bulletPrefab);e.getComponent(i.default).target=this.enemy.position,e.getComponent(i.default).from=this.node,e.position=this.node.position,e.parent=this.node.parent,this.playSound("shoot")}},e.prototype.onCollisionEnter=function(e,t){if(e.getComponent(l.default)){var o=e.world.aabb,i=r.Global.TM.positionToTile(new cc.Vec2(o.x,o.y));this._overlap[i.toString()]=!0}},e.prototype.onCollisionExit=function(e,t){if(e.getComponent(l.default)){var o=e.world.aabb,i=r.Global.TM.positionToTile(new cc.Vec2(o.x,o.y));delete this._overlap[i.toString()]}},e.MAX_ELIXIR=10,e.MAX_HEALTH=5,__decorate([s(cc.Prefab)],e.prototype,"bulletPrefab",void 0),__decorate([s(cc.ProgressBar)],e.prototype,"heathProgressBar",void 0),__decorate([s(cc.SpriteFrame)],e.prototype,"enemySpriteFrame",void 0),e=o=__decorate([c],e);var o}(cc.Component);o.default=p,cc._RF.pop()},{"./add_collider":"add_collider","./bullet":"bullet","./card":"card","./global":"global"}]},{},["add_collider","bullet","canvas","card","enemy","global","player"]);